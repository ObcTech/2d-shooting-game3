<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬äº”æœŸæ— é™åœ°å›¾å…»æˆç±»æ¸¸æˆ Demo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            color: white;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            width: 100%;
            box-sizing: border-box;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .game-container {
            position: relative;
            margin: 20px;
            border: 3px solid #34495e;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: #2c3e50;
        }
        
        #gameCanvas {
            display: block;
            background: #34495e;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.5em;
            text-align: center;
        }
        
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .controls {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            max-width: 800px;
            text-align: center;
        }
        
        .controls h3 {
            margin-top: 0;
            color: #3498db;
        }
        
        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .control-item {
            background: rgba(52, 73, 94, 0.5);
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }
        
        .features {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            max-width: 800px;
        }
        
        .features h3 {
            margin-top: 0;
            color: #e74c3c;
            text-align: center;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .feature-item {
            background: rgba(231, 76, 60, 0.1);
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
        }
        
        .feature-item h4 {
            margin: 0 0 10px 0;
            color: #e74c3c;
        }
        
        .error {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            padding: 15px;
            border-radius: 5px;
            margin: 20px;
            border: 1px solid #e74c3c;
        }
        
        .success {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
            padding: 15px;
            border-radius: 5px;
            margin: 20px;
            border: 1px solid #27ae60;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .game-container {
                margin: 10px;
            }
            
            #gameCanvas {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ® ç¬¬äº”æœŸæ— é™åœ°å›¾å…»æˆç±»æ¸¸æˆ</h1>
        <p>æ¢ç´¢æ— é™ä¸–ç•Œï¼Œå»ºè®¾åŸºåœ°ï¼ŒåŸ¹å…»è§’è‰²ï¼Œå®Œæˆä»»åŠ¡</p>
    </div>
    
    <div class="game-container">
        <canvas id="gameCanvas" width="1000" height="600"></canvas>
        <div class="loading" id="loadingScreen">
            <div class="loading-spinner"></div>
            <div>æ­£åœ¨åŠ è½½æ¸¸æˆ...</div>
        </div>
    </div>
    
    <div class="controls">
        <h3>ğŸ¯ æ¸¸æˆæ§åˆ¶</h3>
        <div class="control-grid">
            <div class="control-item">
                <strong>ç§»åŠ¨:</strong> WASD æˆ– æ–¹å‘é”®
            </div>
            <div class="control-item">
                <strong>èƒŒåŒ…:</strong> I é”®
            </div>
            <div class="control-item">
                <strong>è§’è‰²é¢æ¿:</strong> C é”®
            </div>
            <div class="control-item">
                <strong>å»ºé€ é¢æ¿:</strong> B é”®
            </div>
            <div class="control-item">
                <strong>ä»»åŠ¡é¢æ¿:</strong> Q é”®
            </div>
            <div class="control-item">
                <strong>å»ºé€ æ¨¡å¼:</strong> G é”®
            </div>
            <div class="control-item">
                <strong>å–æ¶ˆæ“ä½œ:</strong> ESC é”®
            </div>
            <div class="control-item">
                <strong>äº¤äº’:</strong> é¼ æ ‡å·¦é”®
            </div>
        </div>
    </div>
    
    <div class="features">
        <h3>ğŸš€ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h3>
        <div class="feature-grid">
            <div class="feature-item">
                <h4>ğŸ—ºï¸ æ— é™åœ°å›¾ç³»ç»Ÿ</h4>
                <p>ç¨‹åºåŒ–ç”Ÿæˆçš„æ— é™ä¸–ç•Œï¼ŒåŒ…å«æ£®æ—ã€æ²™æ¼ ã€é›ªåœ°ã€ç«å±±ã€æµ·æ´‹ç­‰å¤šç§ç”Ÿç‰©ç¾¤ç³»ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰ç‹¬ç‰¹çš„èµ„æºå’ŒæŒ‘æˆ˜ã€‚</p>
            </div>
            <div class="feature-item">
                <h4>ğŸ“ˆ æ·±åº¦å…»æˆç³»ç»Ÿ</h4>
                <p>å¤šç»´åº¦è§’è‰²æˆé•¿ï¼ŒåŒ…æ‹¬ç­‰çº§ã€å±æ€§ç‚¹åˆ†é…ã€æŠ€èƒ½æ ‘å­¦ä¹ ã€è£…å¤‡ç³»ç»Ÿï¼Œæ‰“é€ ç‹¬ç‰¹çš„è§’è‰²buildã€‚</p>
            </div>
            <div class="feature-item">
                <h4>ğŸ—ï¸ åŸºåœ°å»ºè®¾ç³»ç»Ÿ</h4>
                <p>å»ºé€ å’Œç®¡ç†ä½ çš„åŸºåœ°ï¼ŒåŒ…æ‹¬èµ„æºç”Ÿäº§ã€é˜²å¾¡è®¾æ–½ã€ç ”ç©¶å®éªŒå®¤ç­‰å¤šç§å»ºç­‘ç±»å‹ã€‚</p>
            </div>
            <div class="feature-item">
                <h4>ğŸ“‹ ä»»åŠ¡ç³»ç»Ÿ</h4>
                <p>ä¸°å¯Œçš„ä»»åŠ¡ä½“ç³»ï¼ŒåŒ…æ‹¬ä¸»çº¿ä»»åŠ¡ã€æ”¯çº¿ä»»åŠ¡ã€æ—¥å¸¸ä»»åŠ¡å’Œæˆå°±ç³»ç»Ÿï¼Œå¼•å¯¼ç©å®¶æ¢ç´¢æ¸¸æˆä¸–ç•Œã€‚</p>
            </div>
            <div class="feature-item">
                <h4>ğŸ’ èµ„æºæ”¶é›†</h4>
                <p>æ”¶é›†æœ¨æã€çŸ³å¤´ã€é‡‘å±ã€é£Ÿç‰©ç­‰å„ç§èµ„æºï¼Œç”¨äºå»ºé€ ã€åˆ¶ä½œå’Œå‡çº§ã€‚</p>
            </div>
            <div class="feature-item">
                <h4>âš”ï¸ æˆ˜æ–—ç³»ç»Ÿ</h4>
                <p>ä¸å„ç§æ•Œäººæˆ˜æ–—ï¼Œè·å¾—ç»éªŒå’Œå¥–åŠ±ï¼Œæå‡è§’è‰²å®åŠ›ã€‚</p>
            </div>
            <div class="feature-item">
                <h4>âœ¨ è§†è§‰ç‰¹æ•ˆ</h4>
                <p>ç²¾ç¾çš„ç²’å­ç‰¹æ•ˆç³»ç»Ÿï¼Œä¸ºæ¸¸æˆå¢æ·»è§†è§‰é­…åŠ›ã€‚</p>
            </div>
            <div class="feature-item">
                <h4>âš¡ æ€§èƒ½ä¼˜åŒ–</h4>
                <p>æ™ºèƒ½çš„åŒºå—åŠ è½½å’Œå¸è½½ç³»ç»Ÿï¼Œç¡®ä¿æ¸¸æˆåœ¨å¤§ä¸–ç•Œä¸­çš„æµç•…è¿è¡Œã€‚</p>
            </div>
        </div>
    </div>
    
    <!-- å¼•å…¥ä¾èµ–çš„JavaScriptæ–‡ä»¶ -->
    <script src="config.js"></script>
    <script src="performance-optimization.js"></script>
    <script src="enhanced-particles.js"></script>
    <script src="config-manager.js"></script>
    <script src="infinite-map-generator.js"></script>
    <script src="character-progression.js"></script>
    <script src="base-building.js"></script>
    <script src="quest-system.js"></script>
    <script src="infinite-game.js"></script>
    
    <script>
        // æ¸¸æˆåˆå§‹åŒ–
        let game = null;
        
        function initGame() {
            try {
                const canvas = document.getElementById('gameCanvas');
                const loadingScreen = document.getElementById('loadingScreen');
                
                // æ£€æŸ¥æ‰€æœ‰å¿…éœ€çš„ç±»æ˜¯å¦å·²åŠ è½½
                const requiredClasses = [
                    'ConfigManager',
                    'PerformanceOptimization', 
                    'EnhancedParticleSystem',
                    'InfiniteMapGenerator',
                    'CharacterProgression',
                    'BaseBuildingSystem',
                    'QuestSystem',
                    'InfiniteGame'
                ];
                
                const missingClasses = requiredClasses.filter(className => !window[className]);
                
                if (missingClasses.length > 0) {
                    throw new Error(`ç¼ºå°‘å¿…éœ€çš„ç±»: ${missingClasses.join(', ')}`);
                }
                
                // åˆ›å»ºæ¸¸æˆå®ä¾‹
                game = new InfiniteGame(canvas);
                
                // éšè—åŠ è½½å±å¹•
                loadingScreen.style.display = 'none';
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                showMessage('æ¸¸æˆåŠ è½½æˆåŠŸï¼å¼€å§‹ä½ çš„æ— é™å†’é™©ä¹‹æ—…ï¼', 'success');
                
                console.log('ç¬¬äº”æœŸæ— é™åœ°å›¾å…»æˆç±»æ¸¸æˆå¯åŠ¨æˆåŠŸ');
                
            } catch (error) {
                console.error('æ¸¸æˆåˆå§‹åŒ–å¤±è´¥:', error);
                showMessage(`æ¸¸æˆåˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
                
                // éšè—åŠ è½½å±å¹•
                document.getElementById('loadingScreen').style.display = 'none';
            }
        }
        
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.textContent = message;
            
            // æ’å…¥åˆ°æ¸¸æˆå®¹å™¨åé¢
            const gameContainer = document.querySelector('.game-container');
            gameContainer.parentNode.insertBefore(messageDiv, gameContainer.nextSibling);
            
            // 5ç§’åè‡ªåŠ¨ç§»é™¤æˆåŠŸæ¶ˆæ¯
            if (type === 'success') {
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 5000);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ¸¸æˆ
        window.addEventListener('load', () => {
            // å»¶è¿Ÿä¸€ç‚¹æ—¶é—´ç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
            setTimeout(initGame, 100);
        });
        
        // å¤„ç†é¡µé¢å¯è§æ€§å˜åŒ–
        document.addEventListener('visibilitychange', () => {
            if (game) {
                if (document.hidden) {
                    game.gameState = 'paused';
                } else {
                    game.gameState = 'playing';
                }
            }
        });
        
        // å¤„ç†çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', () => {
            if (game) {
                const canvas = document.getElementById('gameCanvas');
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å“åº”å¼è°ƒæ•´é€»è¾‘
            }
        });
        
        // é˜²æ­¢é¡µé¢åˆ·æ–°æ—¶ä¸¢å¤±æ¸¸æˆçŠ¶æ€
        window.addEventListener('beforeunload', (e) => {
            if (game) {
                // è¿™é‡Œå¯ä»¥æ·»åŠ ä¿å­˜æ¸¸æˆçŠ¶æ€çš„é€»è¾‘
                e.preventDefault();
                e.returnValue = 'ç¡®å®šè¦ç¦»å¼€å—ï¼Ÿæ¸¸æˆè¿›åº¦å¯èƒ½ä¼šä¸¢å¤±ã€‚';
            }
        });
    </script>
</body>
</html>